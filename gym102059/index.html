<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000">
  <!-- å¼ºåˆ¶é¡µé¢åœ¨å½“å‰çª—å£ä»¥ç‹¬ç«‹é¡µé¢æ˜¾ç¤º,é˜²æ­¢åˆ«äººåœ¨æ¡†æ¶é‡Œè°ƒç”¨é¡µé¢ -->
  <meta http-equiv="window-target" content="_top">
  
  
  <title>CodeForces gym 102059 ç®€è¦é¢˜è§£ | è‡ªç”±ã‚’æ¸‡æœ›ã™ã‚‹</title>
  <meta name="description" content="Coloring Roadsé¢˜æ„ç®€è¿°ï¼š  ç»™ä¸€æ£µæ ‘ï¼Œæ ‘è¾¹ä¸€å¼€å§‹éƒ½æ˜¯æ— è‰²çš„ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥æŠŠä¸€ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„ä¸Šæ‰€æœ‰è¾¹æŸ“æˆæŸä¸ªé¢œè‰²ï¼Œæ¯æ¬¡è¯¢é—®å½“å‰æ ‘ä¸Šå‡ºç°è¿‡æŸä¸ªæ¬¡æ•°çš„é¢œè‰²ç§æ•°  æ•°æ®èŒƒå›´ï¼š  ç‚¹æ•°ï¼Œæ“ä½œæ•° $\le2\times10^5$  è§£é¢˜æ€è·¯ï¼š  è¿™é¢˜åšæ³•è¿˜è›®å¤šçš„ï¼Œåœ¨è¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹ï¼š  æ ‘é“¾å‰–åˆ†+å•è°ƒæ ˆï¼šå¯¹äºæ¯æ¡é‡é“¾ç»´æŠ¤ä¸€ä¸ªå…³äº $dfs$ åºçš„å•è°ƒé€’å‡æ ˆä»è€Œç»´æŠ¤ç­”æ¡ˆï¼Œæ¯æ¬¡æš´åŠ›ä¿®æ”¹ï¼Œå‡æ‘Šåˆ†æå¤æ‚">
<meta name="keywords" content="æ¯”èµ›é¢˜è§£">
<meta property="og:type" content="article">
<meta property="og:title" content="CodeForces gym 102059 ç®€è¦é¢˜è§£">
<meta property="og:url" content="http://ldxcaicai.github.io/gym102059/index.html">
<meta property="og:site_name" content="è‡ªç”±ã‚’æ¸‡æœ›ã™ã‚‹">
<meta property="og:description" content="Coloring Roadsé¢˜æ„ç®€è¿°ï¼š  ç»™ä¸€æ£µæ ‘ï¼Œæ ‘è¾¹ä¸€å¼€å§‹éƒ½æ˜¯æ— è‰²çš„ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥æŠŠä¸€ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„ä¸Šæ‰€æœ‰è¾¹æŸ“æˆæŸä¸ªé¢œè‰²ï¼Œæ¯æ¬¡è¯¢é—®å½“å‰æ ‘ä¸Šå‡ºç°è¿‡æŸä¸ªæ¬¡æ•°çš„é¢œè‰²ç§æ•°  æ•°æ®èŒƒå›´ï¼š  ç‚¹æ•°ï¼Œæ“ä½œæ•° $\le2\times10^5$  è§£é¢˜æ€è·¯ï¼š  è¿™é¢˜åšæ³•è¿˜è›®å¤šçš„ï¼Œåœ¨è¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹ï¼š  æ ‘é“¾å‰–åˆ†+å•è°ƒæ ˆï¼šå¯¹äºæ¯æ¡é‡é“¾ç»´æŠ¤ä¸€ä¸ªå…³äº $dfs$ åºçš„å•è°ƒé€’å‡æ ˆä»è€Œç»´æŠ¤ç­”æ¡ˆï¼Œæ¯æ¬¡æš´åŠ›ä¿®æ”¹ï¼Œå‡æ‘Šåˆ†æå¤æ‚">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-11-07T10:53:43.276Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CodeForces gym 102059 ç®€è¦é¢˜è§£">
<meta name="twitter:description" content="Coloring Roadsé¢˜æ„ç®€è¿°ï¼š  ç»™ä¸€æ£µæ ‘ï¼Œæ ‘è¾¹ä¸€å¼€å§‹éƒ½æ˜¯æ— è‰²çš„ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥æŠŠä¸€ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„ä¸Šæ‰€æœ‰è¾¹æŸ“æˆæŸä¸ªé¢œè‰²ï¼Œæ¯æ¬¡è¯¢é—®å½“å‰æ ‘ä¸Šå‡ºç°è¿‡æŸä¸ªæ¬¡æ•°çš„é¢œè‰²ç§æ•°  æ•°æ®èŒƒå›´ï¼š  ç‚¹æ•°ï¼Œæ“ä½œæ•° $\le2\times10^5$  è§£é¢˜æ€è·¯ï¼š  è¿™é¢˜åšæ³•è¿˜è›®å¤šçš„ï¼Œåœ¨è¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹ï¼š  æ ‘é“¾å‰–åˆ†+å•è°ƒæ ˆï¼šå¯¹äºæ¯æ¡é‡é“¾ç»´æŠ¤ä¸€ä¸ªå…³äº $dfs$ åºçš„å•è°ƒé€’å‡æ ˆä»è€Œç»´æŠ¤ç­”æ¡ˆï¼Œæ¯æ¬¡æš´åŠ›ä¿®æ”¹ï¼Œå‡æ‘Šåˆ†æå¤æ‚">
  <!-- Canonical links -->
  <link rel="canonical" href="http://ldxcaicai.github.io/gym102059/index.html">
  
    <link rel="alternate" href="/atom.xml" title="è‡ªç”±ã‚’æ¸‡æœ›ã™ã‚‹" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/8.jpg" type="image/x-icon">
  
  <link rel="stylesheet" href="/css/style.css">
  
    <link href="//cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  
  
  
  
</head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/ldxcaicai" target="_blank">
          <img class="img-circle img-rotate" src="/images/ss.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">ldxcaicai</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">a loserğŸ˜¬ğŸ˜¦ğŸ˜­ğŸ˜¢ğŸ˜°</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Chengdu, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">Home</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">Archives</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">Categories</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">Tags</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">Links</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://loj.ac" target="_blank" title="LOJ" data-toggle=tooltip data-placement=top><i class="icon icon-LOJ"></i></a></li>
        
        <li><a href="https://www.luogu.org" target="_blank" title="æ°µå’•" data-toggle=tooltip data-placement=top><i class="icon icon-æ°µå’•"></i></a></li>
        
        <li><a href="http://uoj.ac/" target="_blank" title="UOJ" data-toggle=tooltip data-placement=top><i class="icon icon-UOJ"></i></a></li>
        
        <li><a href="https://vjudge.net" target="_blank" title="Vjudge" data-toggle=tooltip data-placement=top><i class="icon icon-Vjudge"></i></a></li>
        
        <li><a href="http://darkbzoj.tk/" target="_blank" title="Darkbzoj" data-toggle=tooltip data-placement=top><i class="icon icon-darkbzoj"></i></a></li>
        
        <li><a href="https://codeforces.com" target="_blank" title="Codeforces" data-toggle=tooltip data-placement=top><i class="icon icon-Codeforces"></i></a></li>
        
        <li><a href="https://atcoder.jp" target="_blank" title="Atcoder" data-toggle=tooltip data-placement=top><i class="icon icon-Atcoder"></i></a></li>
        
        <li><a href="https://www.codechef.com" target="_blank" title="Codechef" data-toggle=tooltip data-placement=top><i class="icon icon-Codechef"></i></a></li>
        
        <li><a href="http://acm.hdu.edu.cn/" target="_blank" title="HDU" data-toggle=tooltip data-placement=top><i class="icon icon-HDU"></i></a></li>
        
        <li><a href="https://blog.csdn.net/zxyoi_dreamer" target="_blank" title="Zxyoi" data-toggle=tooltip data-placement=top><i class="icon icon-zxyoi"></i></a></li>
        
        <li><a href="https://blog.csdn.net/qq_42555009" target="_blank" title="Backseat_Stargazer" data-toggle=tooltip data-placement=top><i class="icon icon-Backseat_Stargazer"></i></a></li>
        
        <li><a href="https://blog.csdn.net/qq_43346903" target="_blank" title="Romiqi" data-toggle=tooltip data-placement=top><i class="icon icon-romiqi"></i></a></li>
        
        <li><a href="https://blog.csdn.net/qq_43040655" target="_blank" title="Jun" data-toggle=tooltip data-placement=top><i class="icon icon-Jun"></i></a></li>
        
        <li><a href="http://blog.leanote.com/rockdu" target="_blank" title="Rockdu" data-toggle=tooltip data-placement=top><i class="icon icon-Rockdu"></i></a></li>
        
        <li><a href="https://dream-maker-yk.github.io" target="_blank" title="Dream_maker" data-toggle=tooltip data-placement=top><i class="icon icon-dream_maker"></i></a></li>
        
        <li><a href="https://www.cnblogs.com/weiyanpeng/" target="_blank" title="Jerome_wei" data-toggle=tooltip data-placement=top><i class="icon icon-jerome_wei"></i></a></li>
        
        <li><a href="https://blog.csdn.net/John_zyj" target="_blank" title="John_zyj" data-toggle=tooltip data-placement=top><i class="icon icon-John_zyj"></i></a></li>
        
        <li><a href="https://blog.csdn.net/sslz_fsy" target="_blank" title="FSYolanda" data-toggle=tooltip data-placement=top><i class="icon icon-FSYolanda"></i></a></li>
        
        <li><a href="https://blog.csdn.net/qq_42835815" target="_blank" title="Gigo_64" data-toggle=tooltip data-placement=top><i class="icon icon-gigo_64"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">Board</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>æ¬¢è¿äº¤æµä¸æš´æ‰“ldxcaicai!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/private/">private</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/public/">public</a><span class="category-list-count">32</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/å­¦ä¹ ç¬”è®°/">å­¦ä¹ ç¬”è®°</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ¯”èµ›é¢˜è§£/">æ¯”èµ›é¢˜è§£</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ¸¸è®°/">æ¸¸è®°</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/è€ƒè¯•é¢˜è§£/">è€ƒè¯•é¢˜è§£</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/é¢˜è§£/">é¢˜è§£</a><span class="tag-list-count">10</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/å­¦ä¹ ç¬”è®°/" style="font-size: 14px;">å­¦ä¹ ç¬”è®°</a> <a href="/tags/æ¯”èµ›é¢˜è§£/" style="font-size: 14px;">æ¯”èµ›é¢˜è§£</a> <a href="/tags/æ¸¸è®°/" style="font-size: 13px;">æ¸¸è®°</a> <a href="/tags/è€ƒè¯•é¢˜è§£/" style="font-size: 13.5px;">è€ƒè¯•é¢˜è§£</a> <a href="/tags/é¢˜è§£/" style="font-size: 14px;">é¢˜è§£</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">Archive</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a><span class="archive-list-count">10</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/public/">public</a>
              </p>
              <p class="item-title">
                <a href="/pkuwc2020/" class="title">PKUWC2020æ¸¸è®°</a>
              </p>
              <p class="item-date">
                <time datetime="2019-12-23T23:34:57.000Z" itemprop="datePublished">2019-12-24</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/public/">public</a>
              </p>
              <p class="item-title">
                <a href="/sol10/" class="title">æ‚é¢˜ä¹±åš Round10</a>
              </p>
              <p class="item-date">
                <time datetime="2019-12-19T02:10:32.000Z" itemprop="datePublished">2019-12-19</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/public/">public</a>
              </p>
              <p class="item-title">
                <a href="/burnside/" class="title">burnsideå¼•ç†ç®€å•è¯æ˜</a>
              </p>
              <p class="item-date">
                <time datetime="2019-12-16T13:56:40.000Z" itemprop="datePublished">2019-12-16</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/public/">public</a>
              </p>
              <p class="item-title">
                <a href="/PN/" class="title">Powerful Number ç­›å­¦ä¹ ç¬”è®°</a>
              </p>
              <p class="item-date">
                <time datetime="2019-11-30T13:12:34.000Z" itemprop="datePublished">2019-11-30</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/public/">public</a>
              </p>
              <p class="item-title">
                <a href="/sol9/" class="title">æ‚é¢˜ä¹±åš Round9</a>
              </p>
              <p class="item-date">
                <time datetime="2019-11-27T14:19:34.000Z" itemprop="datePublished">2019-11-27</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">Catalogue</h3>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Coloring-Roads"><span class="toc-number">1.</span> <span class="toc-text">Coloring Roads</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dev-Please-Add-This"><span class="toc-number">2.</span> <span class="toc-text">Dev, Please Add This!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dstorv"><span class="toc-number">3.</span> <span class="toc-text">Dstorv</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dumae"><span class="toc-number">4.</span> <span class="toc-text">Dumae</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Electronic-Circuit"><span class="toc-number">5.</span> <span class="toc-text">Electronic Circuit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fake-Plastic-Trees"><span class="toc-number">6.</span> <span class="toc-text">Fake Plastic Trees</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fascination-Street"><span class="toc-number">7.</span> <span class="toc-text">Fascination Street</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fractions"><span class="toc-number">8.</span> <span class="toc-text">Fractions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Game-on-Plane"><span class="toc-number">9.</span> <span class="toc-text">Game on Plane</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Histogram-Sequence"><span class="toc-number">10.</span> <span class="toc-text">Histogram Sequence</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Interesting-Drug"><span class="toc-number">11.</span> <span class="toc-text">Interesting Drug</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Utilitarianism"><span class="toc-number">12.</span> <span class="toc-text">Utilitarianism</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-gym102059" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      CodeForces gym 102059 ç®€è¦é¢˜è§£
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/gym102059/" class="article-date">
	  <time datetime="2019-10-16T23:47:42.000Z" itemprop="datePublished">2019-10-17</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/public/">public</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link" href="/tags/æ¯”èµ›é¢˜è§£/">æ¯”èµ›é¢˜è§£</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/gym102059/#comments" class="article-comment-link">Comments</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h2 id="Coloring-Roads"><a href="#Coloring-Roads" class="headerlink" title="Coloring Roads"></a><a href="https://codeforces.com/gym/102059/problem/A" target="_blank" rel="noopener">Coloring Roads</a></h2><p>é¢˜æ„ç®€è¿°ï¼š</p>
<blockquote>
<p>ç»™ä¸€æ£µæ ‘ï¼Œæ ‘è¾¹ä¸€å¼€å§‹éƒ½æ˜¯æ— è‰²çš„ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥æŠŠä¸€ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„ä¸Šæ‰€æœ‰è¾¹æŸ“æˆæŸä¸ªé¢œè‰²ï¼Œæ¯æ¬¡è¯¢é—®å½“å‰æ ‘ä¸Šå‡ºç°è¿‡æŸä¸ªæ¬¡æ•°çš„é¢œè‰²ç§æ•°</p>
</blockquote>
<p>æ•°æ®èŒƒå›´ï¼š</p>
<ul>
<li>ç‚¹æ•°ï¼Œæ“ä½œæ•° $\le2\times10^5$</li>
</ul>
<p>è§£é¢˜æ€è·¯ï¼š</p>
<blockquote>
<p>è¿™é¢˜åšæ³•è¿˜è›®å¤šçš„ï¼Œåœ¨è¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹ï¼š</p>
<ol>
<li>æ ‘é“¾å‰–åˆ†+å•è°ƒæ ˆï¼šå¯¹äºæ¯æ¡é‡é“¾ç»´æŠ¤ä¸€ä¸ªå…³äº $dfs$ åºçš„å•è°ƒé€’å‡æ ˆä»è€Œç»´æŠ¤ç­”æ¡ˆï¼Œæ¯æ¬¡æš´åŠ›ä¿®æ”¹ï¼Œå‡æ‘Šåˆ†æå¤æ‚åº¦æ˜¯å¯¹çš„</li>
<li>æ ‘é“¾å‰–åˆ†+ $ODT$ ï¼Œç”±äºæœ‰è·¯å¾„è¦†ç›–æ“ä½œï¼Œå› æ­¤å¯ä»¥ç”¨ $ODT$ ç®€å•ç»´æŠ¤ç­”æ¡ˆï¼Œå¤æ‚åº¦åˆ†æè·Ÿåºåˆ—ä¸Šæ˜¯å·®ä¸å¤šçš„</li>
<li>$LCT$ ï¼Œè€ƒè™‘åˆ°è·¯å¾„è¦†ç›–å°±æ˜¯ $LCT$ åœ¨ $access$ çš„æ—¶å€™é¡ºå¸¦ä¿®æ”¹ä¸€ä¸‹ä¿¡æ¯ï¼Œå› æ­¤æ¯æ¬¡æ”¹çš„æ—¶å€™ $access$ å³å¯</li>
</ol>
</blockquote>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">gc</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">char</span> buf[rlen],*ib,*ob;</span><br><span class="line">	(ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,<span class="number">1</span>,rlen,<span class="built_in">stdin</span>));</span><br><span class="line">	<span class="keyword">return</span> ib==ob?<span class="number">-1</span>:*ib++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">4e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;S[N];</span><br><span class="line"><span class="keyword">int</span> cnt[N];</span><br><span class="line"><span class="keyword">namespace</span> lct&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> lc (son[p][0])</span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> rc (son[p][1])</span></span><br><span class="line">	<span class="keyword">int</span> siz[N],fa[N],son[N][<span class="number">2</span>],vl[N],col[N];</span><br><span class="line">	<span class="keyword">bool</span> rev[N];</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">which</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> x==son[fa[x]][<span class="number">1</span>];&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isroot</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> !fa[x]||(son[fa[x]][<span class="number">0</span>]!=x&amp;&amp;son[fa[x]][<span class="number">1</span>]!=x);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;siz[p]=siz[lc]+siz[rc]+vl[p];&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushnow</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> c)</span></span>&#123;col[p]=c;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;(lc&amp;&amp;(col[lc]=col[p])),(rc&amp;&amp;(col[rc]=col[p]));&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> y=fa[x],z=fa[y],t=which(x);</span><br><span class="line">		<span class="keyword">if</span>(!isroot(y))son[z][which(y)]=x;</span><br><span class="line">		fa[x]=z,fa[y]=x,son[y][t]=son[x][t^<span class="number">1</span>],son[x][t^<span class="number">1</span>]=y;</span><br><span class="line">		<span class="keyword">if</span>(son[y][t])fa[son[y][t]]=y;</span><br><span class="line">		pushup(y),pushup(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">		<span class="keyword">static</span> <span class="keyword">int</span> stk[N],top;</span><br><span class="line">		stk[top=<span class="number">1</span>]=x;</span><br><span class="line">		<span class="keyword">for</span>(ri i=x;!isroot(i);i=fa[i])stk[++top]=fa[i];</span><br><span class="line">		<span class="keyword">while</span>(top)pushdown(stk[top--]);</span><br><span class="line">		<span class="keyword">while</span>(!isroot(x))&#123;</span><br><span class="line">			<span class="keyword">if</span>(!isroot(fa[x]))rotate(which(x)^which(fa[x])?x:fa[x]);</span><br><span class="line">			rotate(x);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> p=x;</span><br><span class="line">		<span class="keyword">for</span>(ri y=<span class="number">0</span>;x;x=fa[y=x])&#123;</span><br><span class="line">			splay(x);</span><br><span class="line">			son[x][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">			pushup(x); </span><br><span class="line">			S[cnt[col[x]]].erase(col[x]);</span><br><span class="line">			cnt[col[x]]-=siz[x];</span><br><span class="line">			S[cnt[col[x]]].insert(col[x]);</span><br><span class="line">			son[x][<span class="number">1</span>]=y;</span><br><span class="line">			pushup(x);</span><br><span class="line">			p=x;</span><br><span class="line">		&#125;</span><br><span class="line">		pushnow(p,c);</span><br><span class="line">		S[cnt[col[p]]].erase(col[p]);</span><br><span class="line">		cnt[col[p]]+=siz[p];</span><br><span class="line">		S[cnt[col[p]]].insert(col[p]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">undef</span> lc</span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">undef</span> rc</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,C,m;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;e[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[p].size();++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>((v=e[p][i])==fa)<span class="keyword">continue</span>;</span><br><span class="line">		dfs(v,p);</span><br><span class="line">		lct::fa[lct::fa[v]=v+n]=p;</span><br><span class="line">		lct::siz[v+n]=lct::vl[v+n]=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),C=read(),m=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=C;++i)S[<span class="number">0</span>].insert(i);</span><br><span class="line">	S[n<span class="number">-1</span>].insert(<span class="number">0</span>);</span><br><span class="line">	cnt[<span class="number">0</span>]=n<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>,u,v;i&lt;n;++i)&#123;</span><br><span class="line">		u=read(),v=read();</span><br><span class="line">		e[u].pb(v),e[v].pb(u);</span><br><span class="line">	&#125;</span><br><span class="line">	dfs(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span>(ri x,c,k;m;--m)&#123;</span><br><span class="line">		x=read(),c=read(),k=read();</span><br><span class="line">		lct::access(x,c);</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;S[k].size()-(S[k].count(<span class="number">0</span>)?<span class="number">1</span>:<span class="number">0</span>)&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<hr>
<h2 id="Dev-Please-Add-This"><a href="#Dev-Please-Add-This" class="headerlink" title="Dev, Please Add This!"></a><a href="https://codeforces.com/gym/102059/problem/B" target="_blank" rel="noopener">Dev, Please Add This!</a></h2><p>é¢˜æ„ç®€è¿°ï¼š</p>
<blockquote>
<p>ç»™ä¸€ä¸ª $n*m$ çš„ç½‘æ ¼å›¾ï¼Œä¸€ä¸ªæ ¼å­æ˜¯ç©ºåœ°æˆ–å¢™ï¼Œç©ºåœ°ä¸Šå¯èƒ½æœ‰é“å…·ã€‚ä½ ä»ä¸€ä¸ªä½ç½®å‡ºå‘ï¼Œé€‰ä¸€ä¸ªæ–¹å‘ç„¶åä¸€ç›´æŒ‰é‚£ä¸ªæ–¹å‘èµ°ç›´åˆ°ç¢°åˆ°å¢™æˆ–è¾¹ç•Œã€‚æ²¿é€”çš„æ‰€æœ‰é“å…·éƒ½ä¼šè¢«æ”¶é›†ï¼Œé—®èƒ½å¦æ”¶é›†æ‰€æœ‰é“å…·ã€‚</p>
</blockquote>
<p>æ•°æ®èŒƒå›´ï¼š</p>
<ul>
<li>$n,m\le50$</li>
</ul>
<p>è§£é¢˜æ€è·¯ï¼š</p>
<blockquote>
<p>æ ¹æ®é¢˜æ„ï¼Œæ¯è¡Œæ¯åˆ—éƒ½è¢«è¾¹ç•Œå’Œå¢™åˆ†æˆäº†å¾ˆå¤šå°æ®µï¼Œæˆ‘ä»¬æŠŠè¿™äº›æ®µè¿›è¡Œæ ‡å·ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªé“å…·ï¼Œå®ƒè¢«æ”¶é›†å½“ä¸”ä»…å½“å®ƒæ‰€åœ¨çš„è¡Œåˆ—åˆ†é‡è‡³å°‘æœ‰ä¸€ä¸ªè¢«é€‰ï¼Œäºæ˜¯æƒ³åˆ°ç”¨ $2-sat$ æ¥è¿›è¡Œè¿™ç±»é™åˆ¶ï¼Œç„¶åè€ƒè™‘å‰©ä¸‹çš„é™åˆ¶ï¼Œè‹¥ä»èµ·ç‚¹å‡ºå‘ä¸èƒ½åˆ°è¾¾æŸä¸ªåˆ†é‡ï¼Œé‚£ä¹ˆæœ€åå®ƒå¿…é¡»ä¸º $false$ ï¼Œå¦‚æœä¸¤ä¸ªåˆ†é‡æ²¡æœ‰ä¸€ä¸ªèƒ½åˆ°è¾¾å¦ä¸€ä¸ªï¼Œé‚£ä¹ˆå°±ä¸èƒ½åŒæ—¶ä¸º $true$ ï¼Œå»ºå®Œå›¾ä¹‹åç”¨ $2-sat$ è·‘å³å¯</p>
<p>åˆæ³•æ€§è¯æ˜ï¼šè€ƒè™‘å°†å»ºå‡ºæ¥çš„å›¾ç¼©ç‚¹ï¼Œé‚£ä¹ˆå°±å˜æˆäº†ä¸€å¼ æœ‰å‘å®Œå…¨å›¾ï¼Œä»ä¸€ä¸ªå…¥åº¦ä¸º $0$ çš„ç‚¹å‡ºå‘æ‰¾å“ˆå¯†é¡¿å›è·¯ï¼Œè¿™ä¸ªä¸€å®šèƒ½æ„é€ å‡ºä¸€ç»„è§£</p>
</blockquote>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> buf[rlen],*ib=buf,*ob=buf;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc() (((ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,1,rlen,stdin)),ib==ob)?-1:*ib++)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,<span class="keyword">int</span>&gt; pli;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> Ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Read</span><span class="params">(<span class="keyword">char</span>*s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> top=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="string">'O'</span>&amp;&amp;ch!=<span class="string">'#'</span>&amp;&amp;ch!=<span class="string">'.'</span>&amp;&amp;ch!=<span class="string">'*'</span>)ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch==<span class="string">'O'</span>||ch==<span class="string">'#'</span>||ch==<span class="string">'.'</span>||ch==<span class="string">'*'</span>)s[++top]=ch,ch=gc();</span><br><span class="line">	<span class="keyword">return</span> top;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> modular&#123;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>,inv2=<span class="number">499122177</span>;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> a-b&lt;<span class="number">0</span>?a-b+mod:a-b;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (ll)a*b%mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=add(a,b);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=dec(a,b);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=(ll)a*b%mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))(p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;<span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fix</span><span class="params">(<span class="keyword">int</span>&amp;a)</span></span>&#123;a=(a%mod+mod)%mod;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmax</span><span class="params">(T&amp;a,T b)</span></span>&#123;a&lt;b?a=b:<span class="number">0</span>;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmin</span><span class="params">(T&amp;a,T b)</span></span>&#123;a&gt;b?a=b:<span class="number">0</span>;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">55</span>,M=N*N*<span class="number">4</span>;</span><br><span class="line"><span class="keyword">char</span> s[N][N];</span><br><span class="line"><span class="keyword">int</span> n,m,sig=<span class="number">0</span>,col[M],stk[M],top=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> vs[M];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;e[M];</span><br><span class="line"><span class="keyword">int</span> tot=<span class="number">0</span>,low[M],dfn[M];</span><br><span class="line"><span class="keyword">bool</span> trans[M][M];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">	dfn[p]=low[p]=++tot;</span><br><span class="line">	stk[++top]=p;</span><br><span class="line">	vs[p]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[p].size();++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>(dfn[v=e[p][i]])&#123;</span><br><span class="line">			<span class="keyword">if</span>(vs[v])low[p]=min(low[p],low[v]);</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		dfs(v),low[p]=min(low[p],low[v]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(low[p]==dfn[p])&#123;</span><br><span class="line">		++sig;</span><br><span class="line">		<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">int</span> x=stk[top--];</span><br><span class="line">			vs[x]=<span class="number">0</span>;</span><br><span class="line">			col[x]=sig;</span><br><span class="line">			<span class="keyword">if</span>(x==p)<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> idx1[N][N],idx2[N][N],cnt=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">gettrans</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">	trans[rt][p]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;e[p].size();++i)</span><br><span class="line">	<span class="keyword">if</span>(!trans[rt][e[p][i]])gettrans(e[p][i],rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),m=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)Read(s[i]);</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=n+<span class="number">1</span>;++i)s[i][<span class="number">0</span>]=s[i][m+<span class="number">1</span>]=<span class="string">'#'</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=m+<span class="number">1</span>;++i)s[<span class="number">0</span>][i]=s[n+<span class="number">1</span>][i]=<span class="string">'#'</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)<span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=m;++j)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[i][j<span class="number">-1</span>]==<span class="string">'#'</span>&amp;&amp;s[i][j]!=<span class="string">'#'</span>)++cnt;</span><br><span class="line">		idx1[i][j]=cnt;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=m;++i)<span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=n;++j)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[j<span class="number">-1</span>][i]==<span class="string">'#'</span>&amp;&amp;s[j][i]!=<span class="string">'#'</span>)++cnt;</span><br><span class="line">		idx2[j][i]=cnt;</span><br><span class="line">	&#125;</span><br><span class="line">	++cnt;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)<span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=m;++j)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[i][j]==<span class="string">'#'</span>)<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span>(s[i][j<span class="number">-1</span>]==<span class="string">'#'</span>||s[i][j+<span class="number">1</span>]==<span class="string">'#'</span>)e[idx1[i][j]].pb(idx2[i][j]);</span><br><span class="line">		<span class="keyword">if</span>(s[i<span class="number">-1</span>][j]==<span class="string">'#'</span>||s[i+<span class="number">1</span>][j]==<span class="string">'#'</span>)e[idx2[i][j]].pb(idx1[i][j]);</span><br><span class="line">		<span class="keyword">if</span>(s[i][j]==<span class="string">'O'</span>)e[cnt].pb(idx1[i][j]),e[cnt].pb(idx2[i][j]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=cnt;++i)gettrans(i,i);</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=cnt;++i)e[i].clear();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)<span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=m;++j)<span class="keyword">if</span>(s[i][j]==<span class="string">'*'</span>)&#123;</span><br><span class="line">		e[idx1[i][j]].pb(idx2[i][j]+cnt);</span><br><span class="line">		e[idx2[i][j]].pb(idx1[i][j]+cnt);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;cnt;++i)<span class="keyword">if</span>(!trans[cnt][i])e[i+cnt].pb(i);</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;cnt;++i)<span class="keyword">for</span>(ri j=i+<span class="number">1</span>;j&lt;cnt;++j)<span class="keyword">if</span>(!trans[i][j]&amp;&amp;!trans[j][i])&#123;</span><br><span class="line">		e[i+cnt].pb(j);</span><br><span class="line">		e[j+cnt].pb(i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;cnt*<span class="number">2</span>;++i)<span class="keyword">if</span>(!dfn[i])dfs(i);</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;cnt;++i)<span class="keyword">if</span>(col[i]==col[i+cnt])&#123;</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">"NO"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<hr>
<h2 id="Dstorv"><a href="#Dstorv" class="headerlink" title="Dstorv"></a><a href="https://codeforces.com/gym/102059/problem/C" target="_blank" rel="noopener">Dstorv</a></h2><p>é¢˜æ„ç®€è¿°ï¼š</p>
<blockquote>
<p>æ•°è½´ä¸Šæ’åˆ—ç€ $n$ ä¸ªå·¦/å³ç®­å¤´ï¼Œæ¯ä¸ªç®­å¤´éƒ½ä¼šä»¥ç›¸åŒé€Ÿåº¦æœç€å„è‡ªæ–¹å‘ç§»åŠ¨ã€‚å½“ä¸€ä¸ªå·¦ç®­å¤´å’Œä¸€ä¸ªå³ç®­å¤´ç›¸é‡æ—¶æœ‰æ¦‚ç‡ $p$ ä½¿å¾—å…¶ä¸­å·¦ç®­å¤´æ¶ˆå¤±ï¼Œ $1-p$ æ¦‚ç‡ä½¿å³ç®­å¤´æ¶ˆå¤±ï¼Œé—®æœ€åå‰©ä¸‹ $a$ ä¸ªå³ç®­å¤´å’Œ $b$ ä¸ªå·¦ç®­å¤´çš„æ¦‚ç‡ã€‚</p>
</blockquote>
<p>æ•°æ®èŒƒå›´ï¼š</p>
<ul>
<li>$n\le5000$</li>
</ul>
<p>è§£é¢˜æ€è·¯ï¼š</p>
<blockquote>
<p>å¯¹äºæ¯ä¸€ç§åˆæ³•æ–¹æ¡ˆï¼Œå¯¹åº”ç€åœ¨æœ€å³çš„å·¦ç®­å¤´å’Œæœ€å·¦çš„å³ç®­å¤´ä¹‹é—´åˆ’ä¸€é“åˆ†ç•Œçº¿ï¼Œç„¶ååˆ†ç•Œçº¿å·¦ä¾§çš„å³ç®­å¤´å…¨éƒ¨ $gg$ ï¼Œåˆ†ç•Œçº¿å³ä¾§çš„å·¦ç®­å¤´å…¨éƒ¨ $gg$ ï¼Œè¿™æ ·å¦‚æœç»Ÿè®¡å‡ºåˆ†ç•Œçº¿å·¦å³éƒ¨åˆ†åˆæ³•çš„æ¦‚ç‡å°±å¯ä»¥æšä¸¾åˆ†ç•Œçº¿ç»Ÿè®¡ç­”æ¡ˆ</p>
<p>ç°åœ¨è€ƒè™‘å¦‚ä½•æ±‚æ¦‚ç‡ï¼Œè®¾ $f_{i,j}$ è¡¨ç¤ºä»å·¦åˆ°å³å¤„ç†åˆ°ç¬¬ $i$ ä¸ªç®­å¤´ï¼Œæœ€åä¼šä»å³è¾¹æ¥ $j$ ä¸ªå·¦ç®­å¤´è¿›è¡Œæ”¯æ´ï¼Œæœ€åå‰©ä¸‹ $b$ ä¸ªå·¦ç®­å¤´çš„æ¦‚ç‡ï¼Œç„¶åè½¬ç§»å³å¯ï¼Œå³ä¾§çš„è½¬ç§»åŒç†</p>
</blockquote>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> buf[rlen],*ib=buf,*ob=buf;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc() (((ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,1,rlen,stdin)),ib==ob)?-1:*ib++)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,<span class="keyword">int</span>&gt; pli;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> Ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Read</span><span class="params">(<span class="keyword">char</span>*s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> top=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isalpha</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isalpha</span>(ch))s[++top]=ch,ch=gc();</span><br><span class="line">	<span class="keyword">return</span> top;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> modular&#123;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> a-b&lt;<span class="number">0</span>?a-b+mod:a-b;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (ll)a*b%mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=add(a,b);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=dec(a,b);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=(ll)a*b%mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))(p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;<span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fix</span><span class="params">(<span class="keyword">int</span>&amp;a)</span></span>&#123;a=(a%mod+mod)%mod;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmax</span><span class="params">(T&amp;a,T b)</span></span>&#123;a&lt;b?a=b:<span class="number">0</span>;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmin</span><span class="params">(T&amp;a,T b)</span></span>&#123;a&gt;b?a=b:<span class="number">0</span>;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5005</span>;</span><br><span class="line"><span class="keyword">int</span> f[N][N],g[N][N],pa,pb,p,n,A,B;</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),pa=read(),pb=read();</span><br><span class="line">	Mul(pa,Inv(pa+pb));</span><br><span class="line">	pb=dec(<span class="number">1</span>,pa);</span><br><span class="line">	Read(s);</span><br><span class="line">	A=read(),B=read();</span><br><span class="line">	f[<span class="number">0</span>][B]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[i]==<span class="string">'H'</span>)<span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;n;++j)f[i][j]=f[i<span class="number">-1</span>][j+<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=n;++j)f[i][j]=add(mul(f[i][j<span class="number">-1</span>],pb),mul(f[i<span class="number">-1</span>][j],pa));</span><br><span class="line">	&#125;</span><br><span class="line">	g[n+<span class="number">1</span>][A]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=n;i;--i)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[i]==<span class="string">'R'</span>)<span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;n;++j)g[i][j]=g[i+<span class="number">1</span>][j+<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=n;++j)g[i][j]=add(mul(g[i][j<span class="number">-1</span>],pa),mul(g[i+<span class="number">1</span>][j],pb));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=n;++i)Add(res,mul(f[i][<span class="number">0</span>],g[i+<span class="number">1</span>][<span class="number">0</span>]));</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;res;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<hr>
<h2 id="Dumae"><a href="#Dumae" class="headerlink" title="Dumae"></a><a href="https://codeforces.com/gym/102059/problem/D" target="_blank" rel="noopener">Dumae</a></h2><p>å»ºæ‹“æ‰‘å›¾+è´ªå¿ƒå³å¯</p>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">'-'</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a+=b)&lt;mod?a:(a-=mod);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=(ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,L[N],R[N],du[N],q[N],hd,tl,Du[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;e[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;pii&gt;a[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),m=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)L[i]=read(),R[i]=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>,u,v;i&lt;=m;++i)&#123;</span><br><span class="line">		u=read(),v=read();</span><br><span class="line">		e[u].pb(v),++du[v],++Du[v];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> cnt=n;</span><br><span class="line">	hd=<span class="number">1</span>,tl=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)<span class="keyword">if</span>(!du[i])q[++tl]=i;</span><br><span class="line">	<span class="keyword">while</span>(hd&lt;=tl)&#123;</span><br><span class="line">		<span class="keyword">int</span> x=q[hd++];</span><br><span class="line">		--cnt;</span><br><span class="line">		<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[x].size();++i)&#123;</span><br><span class="line">			--du[v=e[x][i]];</span><br><span class="line">			<span class="keyword">if</span>(!du[v])q[++tl]=v;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(cnt)<span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>),<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri p,i=n;i;--i)&#123;</span><br><span class="line">		p=q[i];</span><br><span class="line">		<span class="keyword">for</span>(ri j=<span class="number">0</span>,v;j&lt;e[p].size();++j)R[p]=min(R[p],R[v=e[p][j]]<span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">set</span>&lt;pii&gt;S,qu;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;ans;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)<span class="keyword">if</span>(!Du[i])&#123;</span><br><span class="line">		<span class="keyword">if</span>(L[i]==<span class="number">1</span>)qu.insert(pii(R[i],i));</span><br><span class="line">		<span class="keyword">else</span> S.insert(pii(L[i],i));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(qu.size())&#123;</span><br><span class="line">		<span class="keyword">int</span> x=qu.begin()-&gt;se;</span><br><span class="line">		qu.erase(qu.begin());</span><br><span class="line">		++cnt;</span><br><span class="line">		<span class="keyword">if</span>(R[x]&lt;cnt)<span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>),<span class="number">0</span>;</span><br><span class="line">		ans.pb(x);</span><br><span class="line">		<span class="keyword">while</span>(S.size()&amp;&amp;S.begin()-&gt;fi&lt;=cnt+<span class="number">1</span>)qu.insert(pii(R[S.begin()-&gt;se],S.begin()-&gt;se)),S.erase(S.begin());</span><br><span class="line">		<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[x].size();++i)&#123;</span><br><span class="line">			--Du[v=e[x][i]];</span><br><span class="line">			<span class="keyword">if</span>(!Du[v])&#123;</span><br><span class="line">				<span class="keyword">if</span>(L[v]&lt;=cnt+<span class="number">1</span>)qu.insert(pii(R[v],v));</span><br><span class="line">				<span class="keyword">else</span> S.insert(pii(L[v],v));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(ans.size()!=n)<span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>),<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;ans.size();++i)<span class="built_in">cout</span>&lt;&lt;ans[i]&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<hr>
<h2 id="Electronic-Circuit"><a href="#Electronic-Circuit" class="headerlink" title="Electronic Circuit"></a><a href="https://codeforces.com/gym/102059/problem/E" target="_blank" rel="noopener">Electronic Circuit</a></h2><p>é€†å‘è€ƒè™‘ç„¶åæŒ‰ç…§é¢˜æ„æ¨¡æ‹Ÿ</p>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">'-'</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a+=b)&lt;mod?a:(a-=mod);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=(ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;e[N];</span><br><span class="line"><span class="keyword">bool</span> ban[N];</span><br><span class="line"><span class="keyword">int</span> n,m,cnt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(ban[p])<span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">if</span>(e[p].size()^<span class="number">2</span>)<span class="keyword">return</span>;</span><br><span class="line">	--cnt;</span><br><span class="line">	ban[p]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> pre=*e[p].begin(),suf=*e[p].rbegin();</span><br><span class="line">	e[pre].erase(p);</span><br><span class="line">	e[pre].insert(suf);</span><br><span class="line">	e[suf].erase(p);</span><br><span class="line">	e[suf].insert(pre);</span><br><span class="line">	modify(pre),modify(suf);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),m=read();</span><br><span class="line">	cnt=n;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>,u,v;i&lt;=m;++i)&#123;</span><br><span class="line">		u=read(),v=read();</span><br><span class="line">		e[u].insert(v);</span><br><span class="line">		e[v].insert(u);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)modify(i);</span><br><span class="line">	<span class="built_in">puts</span>(cnt==<span class="number">2</span>?<span class="string">"Yes"</span>:<span class="string">"No"</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<hr>
<h2 id="Fake-Plastic-Trees"><a href="#Fake-Plastic-Trees" class="headerlink" title="Fake Plastic Trees"></a><a href="https://codeforces.com/gym/102059/problem/F" target="_blank" rel="noopener">Fake Plastic Trees</a></h2><p>æ¯æ¬¡å‡åˆ†å¶å­ç»™å­æ ‘ï¼Œè®°å¿†åŒ–ä¸€ä¸‹å°±è¡Œäº†</p>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">'-'</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a+=b)&lt;mod?a:(a-=mod);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=(ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt;vl;</span><br><span class="line"><span class="built_in">map</span>&lt;ll,<span class="keyword">int</span>&gt;idx;</span><br><span class="line"><span class="built_in">map</span>&lt;ll,<span class="keyword">bool</span>&gt;vs;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(vs[x])<span class="keyword">return</span>;</span><br><span class="line">	vs[x]=<span class="number">1</span>;</span><br><span class="line">	vl.pb(x);</span><br><span class="line">	<span class="keyword">if</span>(x==<span class="number">1</span>)<span class="keyword">return</span>;</span><br><span class="line">	dfs(x-(x&gt;&gt;<span class="number">1</span>)),dfs(x&gt;&gt;<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	ll x;</span><br><span class="line">	<span class="keyword">int</span> tot;</span><br><span class="line">	<span class="keyword">for</span>(ri tt=read();tt;--tt)&#123;</span><br><span class="line">		x=readl();</span><br><span class="line">		vl.clear();</span><br><span class="line">		vs.clear();</span><br><span class="line">		dfs(x);</span><br><span class="line">		sort(vl.begin(),vl.end());</span><br><span class="line">		idx.clear();</span><br><span class="line">		tot=<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;vl.size();++i)idx[vl[i]]=++tot;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;tot+<span class="number">1</span>&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="string">' '</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">		<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;vl.size();++i)<span class="built_in">cout</span>&lt;&lt;idx[vl[i]-(vl[i]&gt;&gt;<span class="number">1</span>)]&lt;&lt;<span class="string">' '</span>&lt;&lt;idx[vl[i]&gt;&gt;<span class="number">1</span>]&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;idx[vl.back()]&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<hr>
<h2 id="Fascination-Street"><a href="#Fascination-Street" class="headerlink" title="Fascination Street"></a><a href="https://codeforces.com/gym/102059/problem/G" target="_blank" rel="noopener">Fascination Street</a></h2><p>é¢˜æ„ç®€è¿°ï¼š</p>
<blockquote>
<p>è¡—é“ä¸Šæœ‰ä¸€æ’ç¯ï¼Œä¸€å¼€å§‹å…¨ç­ï¼Œç‚¹äº®æ¯ç›ç¯æœ‰ä¸€å®šä»£ä»·ï¼Œè¦æ±‚æœ€åå¯¹äºæ¯ä¸ªä½ç½®è·ç¦»è‡ªå·±ä¸è¶…è¿‡ $1$ çš„ç¯è‡³å°‘ç‚¹äº®ä¸€ç›ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæœ‰ $k$ æ¬¡æœºä¼šäº¤æ¢ä¸¤ç›ï¼Œé—®æœ€å°ä»£ä»·ã€‚</p>
</blockquote>
<p>æ•°æ®èŒƒå›´ï¼š</p>
<ul>
<li>$n\le250000,k\le9$</li>
</ul>
<p>è§£é¢˜æ€è·¯ï¼š</p>
<blockquote>
<p>ä¸€é“æ¯”è¾ƒæœ‰æ„æ€çš„äºæ¬ å‹ $dp$ ï¼Œè€ƒè™‘åˆ°äº¤æ¢çš„ä¸€å®šæ˜¯ä¸€ç›äº®çš„å’Œä¸€ç›ç­çš„ï¼Œå¯ä»¥å®šä¹‰çŠ¶æ€ $f_{i,0/1,0/1,x,y}$ è¡¨ç¤ºè€ƒè™‘åˆ°ç¬¬ $i$ ç›ç¯ï¼Œæœ€åä¸¤ç›ç¯çš„äº®ç­çŠ¶æ€ï¼Œç°åœ¨å·²ç»æ¢äº† $x$ ç›äº®çš„ç¯ï¼Œ $y$ ç›ç­çš„ç¯ï¼Œç„¶åæšä¸¾å½“å‰ç¯äº®ä¸äº®ï¼Œæ¢ä¸æ¢å³å¯</p>
</blockquote>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">'-'</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">250005</span>;</span><br><span class="line"><span class="keyword">int</span> n,K,vl[N],cur=<span class="number">0</span>;</span><br><span class="line">ll f[<span class="number">2</span>][<span class="number">2</span>][<span class="number">2</span>][<span class="number">10</span>][<span class="number">10</span>],inf;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmin</span><span class="params">(ll&amp;x,ll y)</span></span>&#123;x=x&lt;y?x:y;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),K=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)vl[i]=read();</span><br><span class="line">	<span class="built_in">memset</span>(f[cur=<span class="number">0</span>],<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(f[<span class="number">0</span>]));</span><br><span class="line">	inf=f[cur][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>],f[cur][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">	ll t;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(f[cur^<span class="number">1</span>],<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(f[cur^<span class="number">1</span>]));</span><br><span class="line">		<span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;<span class="number">2</span>;++j)<span class="keyword">for</span>(ri k=<span class="number">0</span>;k&lt;<span class="number">2</span>;++k)<span class="keyword">for</span>(ri a=<span class="number">0</span>;a&lt;=K;++a)<span class="keyword">for</span>(ri b=<span class="number">0</span>;b&lt;=K;++b)&#123;</span><br><span class="line">			<span class="keyword">if</span>(f[cur][j][k][a][b]==inf)<span class="keyword">continue</span>;</span><br><span class="line">			t=f[cur][j][k][a][b];</span><br><span class="line">			ckmin(f[cur^<span class="number">1</span>][k][<span class="number">1</span>][a][b],t+vl[i+<span class="number">1</span>]);</span><br><span class="line">			<span class="keyword">if</span>(j|k)ckmin(f[cur^<span class="number">1</span>][k][<span class="number">0</span>][a][b],t);</span><br><span class="line">			<span class="keyword">if</span>(a&lt;K)ckmin(f[cur^<span class="number">1</span>][k][<span class="number">1</span>][a+<span class="number">1</span>][b],t);</span><br><span class="line">			<span class="keyword">if</span>(b&lt;K&amp;&amp;(j|k))ckmin(f[cur^<span class="number">1</span>][k][<span class="number">0</span>][a][b+<span class="number">1</span>],t+vl[i+<span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		cur^=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	ll ans=inf;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;<span class="number">2</span>;++i)<span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;<span class="number">2</span>;++j)<span class="keyword">for</span>(ri k=<span class="number">0</span>;k&lt;=K;++k)<span class="keyword">if</span>(i|j)ckmin(ans,f[cur][i][j][k][k]);</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<hr>
<h2 id="Fractions"><a href="#Fractions" class="headerlink" title="Fractions"></a><a href="https://codeforces.com/gym/102059/problem/H" target="_blank" rel="noopener">Fractions</a></h2><p>æš´åŠ›æšä¸¾å³å¯</p>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">'-'</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a+=b)&lt;mod?a:(a-=mod);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=(ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	ll a,b,c,d,xl,xr,yl,yr,ans=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;a&gt;&gt;b&gt;&gt;c&gt;&gt;d;</span><br><span class="line">	<span class="keyword">for</span>(ri j,i=<span class="number">1</span>;i&lt;=<span class="number">1000</span>;++i)&#123;</span><br><span class="line">		j=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(;;++j)&#123;</span><br><span class="line">			<span class="keyword">if</span>(__gcd(i,j)!=<span class="number">1</span>)<span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span>(i+j&gt;=<span class="number">1000</span>)<span class="keyword">break</span>;</span><br><span class="line">			xl=a%i?a/i+<span class="number">1</span>:a/i,xr=b/i;</span><br><span class="line">			yl=c%j?c/j+<span class="number">1</span>:c/j,yr=d/j;</span><br><span class="line">			<span class="keyword">if</span>(max(xl,yl)&lt;=min(xr,yr))ans+=min(xr,yr)-max(xl,yl)+<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<hr>
<h2 id="Game-on-Plane"><a href="#Game-on-Plane" class="headerlink" title="Game on Plane"></a><a href="https://codeforces.com/gym/102059/problem/I" target="_blank" rel="noopener">Game on Plane</a></h2><p>æŒ‰ç…§é¢˜æ„æšä¸¾æ–­è¾¹ï¼Œå‘ç°å‰©ä¸‹ä¸¤ä¸ªæˆäº†å­é—®é¢˜ï¼Œäºæ˜¯ç”¨ $SG$ å‡½æ•°å³å¯</p>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">'-'</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a+=b)&lt;mod?a:(a-=mod);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=(ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5005</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],sg[N];</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	sg[<span class="number">2</span>]=sg[<span class="number">3</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">4</span>;i&lt;=<span class="number">5000</span>;++i)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">		<span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;=i<span class="number">-2</span>;++j)vis[sg[j]^sg[i<span class="number">-2</span>-j]]=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(ri j=<span class="number">0</span>;;++j)<span class="keyword">if</span>(!vis[j])&#123;sg[i]=j;<span class="keyword">break</span>;&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	init();</span><br><span class="line">	<span class="keyword">for</span>(ri tt=read();tt;--tt)<span class="built_in">puts</span>(sg[read()]?<span class="string">"First"</span>:<span class="string">"Second"</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<hr>
<h2 id="Histogram-Sequence"><a href="#Histogram-Sequence" class="headerlink" title="Histogram Sequence"></a><a href="https://codeforces.com/gym/102059/problem/J" target="_blank" rel="noopener">Histogram Sequence</a></h2><p>äºŒåˆ†+å•è°ƒæ ˆ+å †å³å¯</p>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> buf[rlen],*ib=buf,*ob=buf;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc() (((ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,1,rlen,stdin)),ib==ob)?-1:*ib++)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,<span class="keyword">int</span>&gt; pli;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> Ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Read</span><span class="params">(<span class="keyword">char</span>*s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> top=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="string">'O'</span>&amp;&amp;ch!=<span class="string">'#'</span>&amp;&amp;ch!=<span class="string">'.'</span>&amp;&amp;ch!=<span class="string">'*'</span>)ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch==<span class="string">'O'</span>||ch==<span class="string">'#'</span>||ch==<span class="string">'.'</span>||ch==<span class="string">'*'</span>)s[++top]=ch,ch=gc();</span><br><span class="line">	<span class="keyword">return</span> top;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> modular&#123;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>,inv2=<span class="number">499122177</span>;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> a-b&lt;<span class="number">0</span>?a-b+mod:a-b;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (ll)a*b%mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=add(a,b);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=dec(a,b);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=(ll)a*b%mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))(p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;<span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fix</span><span class="params">(<span class="keyword">int</span>&amp;a)</span></span>&#123;a=(a%mod+mod)%mod;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmax</span><span class="params">(T&amp;a,T b)</span></span>&#123;a&lt;b?a=b:<span class="number">0</span>;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmin</span><span class="params">(T&amp;a,T b)</span></span>&#123;a&gt;b?a=b:<span class="number">0</span>;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">300005</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],pl[N],pr[N],stk[N],tp;</span><br><span class="line">ll L,R;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	stk[tp=<span class="number">1</span>]=pl[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">2</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="keyword">while</span>(tp&amp;&amp;a[stk[tp]]&gt;=a[i])--tp;</span><br><span class="line">		pl[i]=stk[tp]+<span class="number">1</span>;</span><br><span class="line">		stk[++tp]=i;</span><br><span class="line">	&#125;</span><br><span class="line">	stk[<span class="number">0</span>]=n+<span class="number">1</span>;</span><br><span class="line">	stk[tp=<span class="number">1</span>]=pr[n]=n;</span><br><span class="line">	<span class="keyword">for</span>(ri i=n<span class="number">-1</span>;i;--i)&#123;</span><br><span class="line">		<span class="keyword">while</span>(tp&amp;&amp;a[stk[tp]]&gt;a[i])--tp;</span><br><span class="line">		pr[i]=stk[tp]<span class="number">-1</span>;</span><br><span class="line">		stk[++tp]=i;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">calc</span><span class="params">(ll lm,ll len)</span></span>&#123;</span><br><span class="line">	ll s=max(<span class="number">1l</span>l,len-lm+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> (len+s)*(len-s+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">calc</span><span class="params">(ll lm)</span></span>&#123;</span><br><span class="line">	ll res=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i]&gt;lm)<span class="keyword">continue</span>;</span><br><span class="line">		res+=calc(lm/a[i],pr[i]-pl[i]+<span class="number">1</span>)-calc(lm/a[i],pr[i]-i)-calc(lm/a[i],i-pl[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> max((r-l+<span class="number">1</span>)-len+<span class="number">1</span>,<span class="number">0l</span>l)-max((r-p)-len+<span class="number">1</span>,<span class="number">0l</span>l)-max((p-l)-len+<span class="number">1</span>,<span class="number">0l</span>l);</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">	ll h,w;</span><br><span class="line">	<span class="keyword">int</span> id;</span><br><span class="line">	Node(ll h=<span class="number">0</span>,ll w=<span class="number">0</span>,<span class="keyword">int</span> id=<span class="number">0</span>):h(h),w(w),id(id)&#123;&#125;</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">inline</span> <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(Node a,Node b)&#123;<span class="keyword">return</span> a.h*a.w&gt;b.h*b.w;&#125;</span><br><span class="line">&#125;tmp;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)a[i]=read();</span><br><span class="line">	L=readl(),R=readl();</span><br><span class="line">	init();</span><br><span class="line">	ll l=<span class="number">0</span>,r=<span class="number">1e18</span>,res=<span class="number">1e18</span>;</span><br><span class="line">	<span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">		ll mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(calc(mid)&gt;=L)r=mid<span class="number">-1</span>,res=mid;</span><br><span class="line">		<span class="keyword">else</span> l=mid+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	ll lm=calc(res);</span><br><span class="line">	<span class="keyword">while</span>(L&lt;=R&amp;&amp;L&lt;=lm)&#123;</span><br><span class="line">		++L;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;res&lt;&lt;<span class="string">' '</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	priority_queue&lt;Node&gt;q;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)q.push(Node(a[i],res/a[i]+<span class="number">1</span>,i));</span><br><span class="line">	<span class="keyword">while</span>(L&lt;=R)&#123;</span><br><span class="line">		tmp=q.top();</span><br><span class="line">		q.pop();</span><br><span class="line">		<span class="keyword">int</span> num=calc(tmp.id,pl[tmp.id],pr[tmp.id],tmp.w);</span><br><span class="line">		<span class="keyword">if</span>(!num)<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">while</span>(num&amp;&amp;L&lt;=R)&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;tmp.h*tmp.w&lt;&lt;<span class="string">' '</span>;</span><br><span class="line">			++L;</span><br><span class="line">			--num;</span><br><span class="line">		&#125;</span><br><span class="line">		++tmp.w;</span><br><span class="line">		q.push(tmp);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<hr>
<h2 id="Interesting-Drug"><a href="#Interesting-Drug" class="headerlink" title="Interesting Drug"></a><a href="https://codeforces.com/gym/102059/problem/K" target="_blank" rel="noopener">Interesting Drug</a></h2><p>é¢˜æ„ç®€è¿°ï¼š</p>
<blockquote>
<p>ä¸€æ¡è·¯ä¸ŠæŒ‰é¡ºåºæœ‰ $n$ ç“¶æ¯’è¯ï¼Œå¯¹äº $iâˆˆ[1,n]$ ï¼Œæ±‚å‡ºå¦‚ä¸‹çš„å€¼ï¼šä» $i$ å‡ºå‘ï¼Œæ¯ä¸ªæ—¶åˆ»åƒæ‰å½“å‰ä½ç½®çš„æ¯’è¯ï¼Œç„¶åé€‰æ‹©ä¸‹ä¸€æ­¥åƒå·¦æˆ–å³çš„æ¯’è¯ï¼Œå°†æ¯æ¬¡é€‰æ‹©çš„ä½ç½®ææˆä¸€ä¸ªæ’åˆ— $p$ ï¼Œå…¶ä¼¤å®³å®šä¹‰ä¸º $\sum\limits_{j=1}^nd_j[p_{c_j}=j]$ ï¼Œæ±‚å¯èƒ½çš„æ’åˆ—ä¸­æœ€å¤§çš„ä¼¤å®³å€¼ã€‚</p>
</blockquote>
<p>æ•°æ®èŒƒå›´ï¼š</p>
<ul>
<li>$n\le3\times10^5$</li>
</ul>
<p>è§£é¢˜æ€è·¯ï¼š</p>
<blockquote>
<p>å®¹æ˜“çœ‹å‡ºä¸€ä¸ª $dp$ å³ $f_{i,j}$ è¡¨ç¤ºå·²ç»åƒæ‰åŒºé—´ $[i,j]$ çš„æ¯’è¯åˆ°åƒå®Œçš„æœ€å¤§å€¼ï¼Œè¿™æ ·æ”¾åˆ°äºŒç»´å¹³é¢ä¸Šæ¯æ¬¡è½¬ç§»å¯¹åº”å‘ä¸‹æˆ–è€…å‘å³èµ°ï¼Œè€Œç”±äºæœ€å¤šæœ‰ $2n$ æ¡è½¬ç§»è¾¹ï¼Œå› æ­¤æšä¸¾çºµåæ ‡ï¼Œç”¨æ ‘çŠ¶æ•°ç»„ä¿®æ”¹åç¼€å– $max$ å’ŒæŸ¥è¯¢å‰ç¼€ $max$ å³å¯</p>
</blockquote>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> buf[rlen],*ib=buf,*ob=buf;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc() (((ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,1,rlen,stdin)),ib==ob)?-1:*ib++)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,<span class="keyword">int</span>&gt; pli;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> Ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Read</span><span class="params">(<span class="keyword">char</span>*s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> top=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="string">'O'</span>&amp;&amp;ch!=<span class="string">'#'</span>&amp;&amp;ch!=<span class="string">'.'</span>&amp;&amp;ch!=<span class="string">'*'</span>)ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch==<span class="string">'O'</span>||ch==<span class="string">'#'</span>||ch==<span class="string">'.'</span>||ch==<span class="string">'*'</span>)s[++top]=ch,ch=gc();</span><br><span class="line">	<span class="keyword">return</span> top;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> modular&#123;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>,inv2=<span class="number">499122177</span>;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> a-b&lt;<span class="number">0</span>?a-b+mod:a-b;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (ll)a*b%mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=add(a,b);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=dec(a,b);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=(ll)a*b%mod;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))(p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;<span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fix</span><span class="params">(<span class="keyword">int</span>&amp;a)</span></span>&#123;a=(a%mod+mod)%mod;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmax</span><span class="params">(T&amp;a,T b)</span></span>&#123;a&lt;b?a=b:<span class="number">0</span>;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmin</span><span class="params">(T&amp;a,T b)</span></span>&#123;a&gt;b?a=b:<span class="number">0</span>;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,c[N],d[N];</span><br><span class="line">ll bit[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> x&amp;-x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x,ll v)</span></span>&#123;<span class="keyword">for</span>(;x;x^=lowbit(x))ckmax(bit[x],v);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;ll res=<span class="number">0</span>;<span class="keyword">for</span>(;x&lt;=n;x+=lowbit(x))ckmax(res,bit[x]);<span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;ps[N];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		c[i]=read();</span><br><span class="line">		<span class="keyword">if</span>(c[i]!=<span class="number">1</span>&amp;&amp;c[i]&lt;=i)ps[i-c[i]+<span class="number">1</span>].pb(i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)d[i]=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="keyword">for</span>(ri j=(<span class="keyword">int</span>)ps[i].size()<span class="number">-1</span>;~j;--j)		</span><br><span class="line">		update(ps[i][j]<span class="number">-1</span>,query(ps[i][j])+d[ps[i][j]]);</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;query(i)+(c[i]==<span class="number">1</span>?d[i]:<span class="number">0</span>)&lt;&lt;<span class="string">' '</span>;</span><br><span class="line">		<span class="keyword">if</span>(i+c[i]<span class="number">-1</span>&lt;=n)update(i+c[i]<span class="number">-1</span>,query(i+c[i]<span class="number">-1</span>)+d[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details> 
$$
---
## [Timsort](https://codeforces.com/gym/102059/problem/L)
ç›´æ¥æš´åŠ›å³å¯ï¼Œå¤æ‚åº¦æ˜¯è°ƒå’Œçº§æ•°
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">'-'</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> (ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a+=b)&lt;mod?a:(a-=mod);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>&#123;a=(ll)a*b%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>&#123;<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],f[N][<span class="number">2</span>];</span><br><span class="line">pii ans[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)a[i]=read();</span><br><span class="line">	f[n][<span class="number">0</span>]=f[n][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=n<span class="number">-1</span>;i;--i)&#123;</span><br><span class="line">		f[i][<span class="number">0</span>]=a[i]&lt;=a[i+<span class="number">1</span>]?f[i+<span class="number">1</span>][<span class="number">0</span>]+<span class="number">1</span>:<span class="number">1</span>;</span><br><span class="line">		f[i][<span class="number">1</span>]=a[i]&gt;a[i+<span class="number">1</span>]?f[i+<span class="number">1</span>][<span class="number">1</span>]+<span class="number">1</span>:<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(ri tt=read(),len;tt;--tt)&#123;</span><br><span class="line">		len=read();</span><br><span class="line">		<span class="keyword">if</span>(ans[len].fi)<span class="built_in">cout</span>&lt;&lt;ans[len].fi&lt;&lt;<span class="string">' '</span>&lt;&lt;ans[len].se&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">for</span>(ri t,i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">				++ans[len].fi;</span><br><span class="line">				<span class="keyword">if</span>(f[i][<span class="number">0</span>]&gt;=len)&#123;</span><br><span class="line">					i+=f[i][<span class="number">0</span>]<span class="number">-1</span>;</span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(f[i][<span class="number">1</span>]&gt;=len)&#123;</span><br><span class="line">					i+=f[i][<span class="number">1</span>]<span class="number">-1</span>;</span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				t=max(f[i][<span class="number">0</span>],f[i][<span class="number">1</span>]);</span><br><span class="line">				ans[len].se+=min(n-i+<span class="number">1</span>-t,len-t);</span><br><span class="line">				i+=min(n-i+<span class="number">1</span>,len)<span class="number">-1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;ans[len].fi&lt;&lt;<span class="string">' '</span>&lt;&lt;ans[len].se&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<hr>
<h2 id="Utilitarianism"><a href="#Utilitarianism" class="headerlink" title="Utilitarianism"></a><a href="https://codeforces.com/gym/102059/problem/M" target="_blank" rel="noopener">Utilitarianism</a></h2><p>ç›´æ¥ç”¨ $wqs$ äºŒåˆ†+ç®€å•æ ‘å½¢ $dp$ å³å¯</p>
<details><summary>CODE</summary>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">gc</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">char</span> buf[rlen],*ib,*ob;</span><br><span class="line">	(ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,<span class="number">1</span>,rlen,<span class="built_in">stdin</span>));</span><br><span class="line">	<span class="keyword">return</span> ib==ob?<span class="number">-1</span>:*ib++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">'-'</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">250005</span>;</span><br><span class="line"><span class="keyword">int</span> n,k;</span><br><span class="line"><span class="built_in">vector</span>&lt;pii&gt;e[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dat</span>&#123;</span></span><br><span class="line">	ll a;</span><br><span class="line">	<span class="keyword">int</span> b;</span><br><span class="line">	dat(ll a=<span class="number">0</span>,<span class="keyword">int</span> b=<span class="number">0</span>):a(a),b(b)&#123;&#125;</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">inline</span> dat <span class="keyword">operator</span>+(<span class="keyword">const</span> dat&amp;a,<span class="keyword">const</span> dat&amp;b)&#123;<span class="keyword">return</span> dat(a.a+b.a,a.b+b.b);&#125;</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">inline</span> dat <span class="keyword">operator</span>-(<span class="keyword">const</span> dat&amp;a,<span class="keyword">const</span> dat&amp;b)&#123;<span class="keyword">return</span> dat(a.a-b.a,a.b-b.b);&#125;</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">inline</span> <span class="keyword">bool</span> <span class="keyword">operator</span>&gt;(<span class="keyword">const</span> dat&amp;a,<span class="keyword">const</span> dat&amp;b)&#123;<span class="keyword">return</span> a.a==b.a?a.b&gt;b.b:a.a&gt;b.a;&#125;</span><br><span class="line">&#125;f[N][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> dat <span class="title">max</span><span class="params">(<span class="keyword">const</span> dat&amp;a,<span class="keyword">const</span> dat&amp;b)</span></span>&#123;<span class="keyword">return</span> a&gt;b?a:b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> fa,ll tmp)</span></span>&#123;</span><br><span class="line">	f[p][<span class="number">0</span>]=f[p][<span class="number">1</span>]=dat(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[p].size();++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>((v=e[p][i].fi)==fa)<span class="keyword">continue</span>;</span><br><span class="line">		dfs(v,p,tmp),f[p][<span class="number">0</span>]=f[p][<span class="number">0</span>]+max(f[v][<span class="number">0</span>],f[v][<span class="number">1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	ll w;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[p].size();++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>((v=e[p][i].fi)==fa)<span class="keyword">continue</span>;</span><br><span class="line">		w=e[p][i].se+tmp;</span><br><span class="line">		f[p][<span class="number">1</span>]=max(f[p][<span class="number">1</span>],f[p][<span class="number">0</span>]-max(f[v][<span class="number">0</span>],f[v][<span class="number">1</span>])+f[v][<span class="number">0</span>]+dat(w,<span class="number">1</span>));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">const</span> <span class="keyword">double</span> tmp)</span></span>&#123;</span><br><span class="line">	dfs(<span class="number">1</span>,<span class="number">0</span>,tmp);</span><br><span class="line">	dat t=max(f[<span class="number">1</span>][<span class="number">0</span>],f[<span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">return</span> t.b&gt;=k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">"lx.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),k=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)e[i].clear();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>,u,v,w;i&lt;n;++i)&#123;</span><br><span class="line">		u=read(),v=read(),w=read();</span><br><span class="line">		e[u].push_back(pii(v,w));</span><br><span class="line">		e[v].push_back(pii(u,w));</span><br><span class="line">	&#125;</span><br><span class="line">	ll L=<span class="number">-1e14</span>,R=<span class="number">1e14</span>,ans=<span class="number">1e14</span>;</span><br><span class="line">	<span class="keyword">while</span>(L&lt;R)&#123;</span><br><span class="line">		ll mid=(L+R+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">		<span class="keyword">if</span>(check(mid))ans=mid,R=mid<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">else</span> L=mid+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	dfs(<span class="number">1</span>,<span class="number">0</span>,ans);</span><br><span class="line">	dat t=max(f[<span class="number">1</span>][<span class="number">0</span>],f[<span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">if</span>(t.b&lt;k)<span class="built_in">puts</span>(<span class="string">"Impossible"</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;(t.a-ans*k)&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<p>æ€»ç»“ï¼š</p>
<ul>
<li>æˆ‘ <font color="red">$dp$</font> ä¸è¿‡å…³</li>
<li>æˆ‘<font color="red">$å›¾è®º$</font>ä¸è¿‡å…³</li>
<li>æˆ‘<font color="red">$è‹±è¯­$</font>ä¸è¿‡å…³</li>
</ul>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
      <a href="http://ldxcaicai.github.io/gym102059/" title="CodeForces gym 102059 ç®€è¦é¢˜è§£" target="_blank" rel="external">http://ldxcaicai.github.io/gym102059/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>ç‰ˆæƒå£°æ˜ï¼š </strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CNåè®®</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/ldxcaicai" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/ss.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/ldxcaicai" target="_blank"><span class="text-dark">ldxcaicai</span><small class="ml-1x">a loserğŸ˜¬ğŸ˜¦ğŸ˜­ğŸ˜¢ğŸ˜°</small></a></h3>
        <div>Glory is just in sight.</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="lv-container" data-id="city" data-uid="MTAyMC80NjgzMC8yMzMzMQ==">
        <noscript> ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
      </div>    
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/sol1/" title="æ‚é¢˜ä¹±åš Round1"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;Newer</span></a>
    </li>
    
    
    <li class="next">
      <a href="/191015test/" title="2019.10.15 æ¨¡æ‹Ÿæµ‹è¯•é¢˜è§£"><span>Older&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="Catalogue" role="button">
        <span>[&nbsp;</span><span>Catalogue</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  
  <div class="bar-right">
    
  </div>
  </div>
</nav>
  


</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://loj.ac" target="_blank" title="LOJ" data-toggle=tooltip data-placement=top><i class="icon icon-LOJ"></i></a></li>
        
        <li><a href="https://www.luogu.org" target="_blank" title="æ°µå’•" data-toggle=tooltip data-placement=top><i class="icon icon-æ°µå’•"></i></a></li>
        
        <li><a href="http://uoj.ac/" target="_blank" title="UOJ" data-toggle=tooltip data-placement=top><i class="icon icon-UOJ"></i></a></li>
        
        <li><a href="https://vjudge.net" target="_blank" title="Vjudge" data-toggle=tooltip data-placement=top><i class="icon icon-Vjudge"></i></a></li>
        
        <li><a href="http://darkbzoj.tk/" target="_blank" title="Darkbzoj" data-toggle=tooltip data-placement=top><i class="icon icon-darkbzoj"></i></a></li>
        
        <li><a href="https://codeforces.com" target="_blank" title="Codeforces" data-toggle=tooltip data-placement=top><i class="icon icon-Codeforces"></i></a></li>
        
        <li><a href="https://atcoder.jp" target="_blank" title="Atcoder" data-toggle=tooltip data-placement=top><i class="icon icon-Atcoder"></i></a></li>
        
        <li><a href="https://www.codechef.com" target="_blank" title="Codechef" data-toggle=tooltip data-placement=top><i class="icon icon-Codechef"></i></a></li>
        
        <li><a href="http://acm.hdu.edu.cn/" target="_blank" title="HDU" data-toggle=tooltip data-placement=top><i class="icon icon-HDU"></i></a></li>
        
        <li><a href="https://blog.csdn.net/zxyoi_dreamer" target="_blank" title="Zxyoi" data-toggle=tooltip data-placement=top><i class="icon icon-zxyoi"></i></a></li>
        
        <li><a href="https://blog.csdn.net/qq_42555009" target="_blank" title="Backseat_Stargazer" data-toggle=tooltip data-placement=top><i class="icon icon-Backseat_Stargazer"></i></a></li>
        
        <li><a href="https://blog.csdn.net/qq_43346903" target="_blank" title="Romiqi" data-toggle=tooltip data-placement=top><i class="icon icon-romiqi"></i></a></li>
        
        <li><a href="https://blog.csdn.net/qq_43040655" target="_blank" title="Jun" data-toggle=tooltip data-placement=top><i class="icon icon-Jun"></i></a></li>
        
        <li><a href="http://blog.leanote.com/rockdu" target="_blank" title="Rockdu" data-toggle=tooltip data-placement=top><i class="icon icon-Rockdu"></i></a></li>
        
        <li><a href="https://dream-maker-yk.github.io" target="_blank" title="Dream_maker" data-toggle=tooltip data-placement=top><i class="icon icon-dream_maker"></i></a></li>
        
        <li><a href="https://www.cnblogs.com/weiyanpeng/" target="_blank" title="Jerome_wei" data-toggle=tooltip data-placement=top><i class="icon icon-jerome_wei"></i></a></li>
        
        <li><a href="https://blog.csdn.net/John_zyj" target="_blank" title="John_zyj" data-toggle=tooltip data-placement=top><i class="icon icon-John_zyj"></i></a></li>
        
        <li><a href="https://blog.csdn.net/sslz_fsy" target="_blank" title="FSYolanda" data-toggle=tooltip data-placement=top><i class="icon icon-FSYolanda"></i></a></li>
        
        <li><a href="https://blog.csdn.net/qq_42835815" target="_blank" title="Gigo_64" data-toggle=tooltip data-placement=top><i class="icon icon-gigo_64"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        &copy; 2019 ldxcaicai
        
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script src="/js/plugin.min.js"></script>
<script src="/js/application.js"></script>

    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>





   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   
    
<script defer type="text/javascript">
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];

    if (typeof LivereTower === 'function') { return; }

    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;

    e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>








<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!-- <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body>
</html>